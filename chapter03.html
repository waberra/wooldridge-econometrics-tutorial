<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: Multiple Regression Analysis | Wooldridge Econometrics Tutorial</title>
    
    <!-- ZERO External Dependencies - Only Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS Custom Properties */
        :root {
            --primary-indigo: #4338ca;
            --secondary-violet: #7c3aed;
            --accent-emerald: #059669;
            --accent-amber: #f59e0b;
            --accent-rose: #e11d48;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.05);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', sans-serif;
            background: linear-gradient(135deg, #fafbff 0%, #f0f4ff 50%, #e8f0fe 100%);
            color: var(--gray-800);
            line-height: 1.7;
        }

        /* Navigation */
        .nav-header {
            background: linear-gradient(135deg, white, #fcfcff);
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-indigo);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .nav-breadcrumb a {
            color: var(--primary-indigo);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .nav-breadcrumb a:hover {
            color: var(--secondary-violet);
        }

        .nav-controls {
            display: flex;
            gap: 0.75rem;
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-violet));
            color: white;
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-md);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .nav-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* Main Content Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section {
            margin: 4rem 0;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.75rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 2.5rem;
            position: relative;
            text-align: center;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -1rem;
            left: 50%;
            transform: translateX(-50%);
            width: 5rem;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-emerald), var(--accent-amber));
            border-radius: 3px;
        }

        .subsection-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.9rem;
            font-weight: 600;
            color: var(--gray-800);
            margin: 2.5rem 0 1.5rem 0;
        }

        /* Chapter Header */
        .chapter-header {
            background: linear-gradient(135deg, var(--primary-indigo) 0%, var(--secondary-violet) 50%, #5b21b6 100%);
            color: white;
            padding: 5rem 0;
            margin-bottom: 4rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .chapter-number {
            font-size: 1.3rem;
            opacity: 0.85;
            margin-bottom: 1.5rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .chapter-title {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.1;
        }

        .chapter-subtitle {
            font-size: 1.35rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.5;
            font-weight: 400;
        }

        /* Content Cards */
        .content-card {
            background: linear-gradient(135deg, white, #fafbff);
            border-radius: 16px;
            padding: 2.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(67, 56, 202, 0.1);
        }

        /* Text Boxes */
        .definition-box {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border: 1px solid rgba(67, 56, 202, 0.3);
            border-left: 5px solid var(--primary-indigo);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }

        .definition-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--primary-indigo);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .example-box {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 1px solid rgba(5, 150, 105, 0.3);
            border-left: 5px solid var(--accent-emerald);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }

        .example-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--accent-emerald);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .formula-box {
            background: linear-gradient(135deg, var(--gray-100), white);
            border: 2px solid var(--gray-300);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            box-shadow: var(--shadow-md);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .key-insight {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 1px solid rgba(245, 158, 11, 0.4);
            border-left: 5px solid var(--accent-amber);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }

        .insight-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--accent-amber);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border: 1px solid rgba(225, 29, 72, 0.3);
            border-left: 5px solid var(--accent-rose);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }

        .warning-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--accent-rose);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        /* Interactive Widgets */
        .interactive-widget {
            background: linear-gradient(135deg, white, #fafbff);
            border: 3px solid var(--primary-indigo);
            border-radius: 16px;
            padding: 2.5rem;
            margin: 3rem 0;
            box-shadow: 0 25px 50px -12px rgb(67 56 202 / 0.25);
            position: relative;
        }

        .widget-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-indigo);
            margin-bottom: 0.75rem;
        }

        .widget-description {
            color: var(--gray-600);
            line-height: 1.6;
            font-size: 1.05rem;
            margin-bottom: 2rem;
        }

        .controls-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .control {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .control-label {
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.95rem;
        }

        .control-select {
            padding: 1rem;
            border: 2px solid var(--gray-300);
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .control-select:focus {
            outline: none;
            border-color: var(--primary-indigo);
            box-shadow: 0 0 0 3px rgba(67, 56, 202, 0.1);
        }

        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-violet));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-align: center;
            font-size: 1rem;
            box-shadow: var(--shadow-lg);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent-emerald), #047857);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--accent-amber), #d97706);
        }

        /* Results panel */
        .results-panel {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 2px solid var(--primary-indigo);
            box-shadow: var(--shadow-lg);
        }

        .results-title {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            color: var(--primary-indigo);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .coefficient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .coefficient-card {
            background: var(--gray-50);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--gray-200);
        }

        .coefficient-label {
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.9rem;
        }

        .coefficient-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-indigo);
            margin-top: 0.25rem;
        }

        .visualization-simple {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-xl);
            border: 2px solid var(--primary-indigo);
            min-height: 300px;
        }

        /* Quiz Styles */
        .quiz-question {
            background: linear-gradient(135deg, var(--gray-50), white);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
        }

        .quiz-question:hover {
            box-shadow: var(--shadow-md);
        }

        .quiz-options {
            margin: 1.5rem 0;
        }

        .quiz-options label {
            display: block;
            padding: 1rem 1.25rem;
            margin: 0.75rem 0;
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .quiz-options label:hover {
            background: var(--gray-50);
            border-color: var(--primary-indigo);
            transform: translateX(5px);
        }

        .quiz-options label.selected {
            background: var(--primary-indigo);
            color: white;
            border-color: var(--primary-indigo);
        }

        .quiz-options label.correct {
            background: var(--accent-emerald);
            color: white;
            border-color: var(--accent-emerald);
        }

        .quiz-options label.incorrect {
            background: var(--accent-rose);
            color: white;
            border-color: var(--accent-rose);
        }

        .quiz-feedback {
            margin-top: 1.5rem;
            padding: 1.25rem;
            border-radius: 10px;
            background: var(--gray-50);
            border-left: 5px solid var(--primary-indigo);
            font-weight: 500;
        }

        .quiz-feedback.correct {
            background: #f0fdf4;
            border-color: var(--accent-emerald);
            color: #166534;
        }

        .quiz-feedback.incorrect {
            background: #fef2f2;
            border-color: var(--accent-rose);
            color: #991b1b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }

            .chapter-title {
                font-size: 2.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .nav-container {
                flex-direction: column;
                gap: 1.5rem;
            }

            .nav-controls {
                order: -1;
            }

            .controls-group {
                grid-template-columns: 1fr;
            }

            .interactive-widget {
                padding: 1.5rem;
            }
        }

        /* Simple scatter plot styles */
        .scatter-plot {
            width: 100%;
            height: 300px;
            background: white;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .plot-point {
            position: absolute;
            width: 6px;
            height: 6px;
            background: var(--primary-indigo);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .plot-axis {
            position: absolute;
            background: var(--gray-400);
        }

        .axis-x {
            bottom: 30px;
            left: 40px;
            right: 20px;
            height: 1px;
        }

        .axis-y {
            bottom: 30px;
            left: 40px;
            top: 20px;
            width: 1px;
        }

        .axis-label {
            position: absolute;
            font-size: 12px;
            color: var(--gray-600);
        }

        .axis-label.x {
            bottom: 10px;
            right: 50%;
            transform: translateX(50%);
        }

        .axis-label.y {
            top: 50%;
            left: 10px;
            transform: translateY(-50%) rotate(-90deg);
            transform-origin: center;
        }

        /* Icon substitutes using Unicode */
        .icon {
            display: inline-block;
            margin-right: 0.5rem;
        }

        .icon-chart::before { content: "üìä"; }
        .icon-calculator::before { content: "üßÆ"; }
        .icon-lightbulb::before { content = "üí°"; }
        .icon-warning::before { content: "‚ö†Ô∏è"; }
        .icon-success::before { content: "‚úÖ"; }
        .icon-arrow-left::before { content: "‚Üê"; }
        .icon-arrow-right::before { content: "‚Üí"; }
        .icon-dice::before { content: "üé≤"; }
        .icon-eye::before { content: "üëÅ"; }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <nav class="nav-header">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <span class="icon icon-chart"></span>
                Econometrics Tutorial
            </a>
            <div class="nav-breadcrumb">
                <a href="index.html">Home</a>
                <span> > </span>
                <span>Chapter 3</span>
            </div>
            <div class="nav-controls">
                <a href="chapter02.html" class="nav-btn">
                    <span class="icon icon-arrow-left"></span>
                    Previous
                </a>
                <a href="#" class="nav-btn" onclick="showChapter4ComingSoon(); return false;">
                    Next
                    <span class="icon icon-arrow-right"></span>
                </a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Chapter Header -->
        <header class="chapter-header">
            <div class="chapter-number">Chapter 3</div>
            <h1 class="chapter-title">Multiple Regression Analysis</h1>
            <p class="chapter-subtitle">
                Master the power of multiple explanatory variables and understand the true ceteris paribus effects in economic relationships
            </p>
        </header>

        <!-- Section 3.1: Motivation for Multiple Regression -->
        <section class="section">
            <h2 class="section-title">3.1 Motivation for Multiple Regression</h2>
            
            <div class="content-card">
                <p>Simple regression analysis is often inadequate for empirical analysis because economic outcomes depend on multiple factors. Multiple regression allows us to estimate ceteris paribus effects.</p>
                
                <div class="definition-box">
                    <div class="definition-title">Multiple Linear Regression Model</div>
                    <p>A model that relates y to several explanatory variables:</p>
                    <div class="formula-box">
                        y = Œ≤‚ÇÄ + Œ≤‚ÇÅx‚ÇÅ + Œ≤‚ÇÇx‚ÇÇ + ‚ãØ + Œ≤‚Çñx‚Çñ + u
                    </div>
                    <p>Where:</p>
                    <ul style="margin-top: 1rem; padding-left: 2rem;">
                        <li><strong>y</strong> = dependent variable</li>
                        <li><strong>x‚ÇÅ, x‚ÇÇ, ..., x‚Çñ</strong> = explanatory variables</li>
                        <li><strong>Œ≤‚ÇÄ</strong> = intercept parameter</li>
                        <li><strong>Œ≤‚ÇÅ, Œ≤‚ÇÇ, ..., Œ≤‚Çñ</strong> = slope parameters (partial effects)</li>
                        <li><strong>u</strong> = error term</li>
                    </ul>
                </div>
                
                <h3 class="subsection-title">The Problem with Simple Regression</h3>
                
                <div class="warning-box">
                    <div class="warning-title">Omitted Variable Bias</div>
                    <p>When important variables are omitted from a regression, the estimated coefficients for included variables may be biased. This occurs when:</p>
                    <ol style="margin-top: 1rem; padding-left: 2rem;">
                        <li>The omitted variable affects the dependent variable</li>
                        <li>The omitted variable is correlated with an included explanatory variable</li>
                    </ol>
                </div>
                
                <div class="example-box">
                    <div class="example-title">Economic Example: Wage Determination</div>
                    <p><strong>Simple Model:</strong> wage = Œ≤‚ÇÄ + Œ≤‚ÇÅ ¬∑ educ + u</p>
                    <p><strong>Problem:</strong> Œ≤‚ÇÅ captures not just the effect of education, but also the effects of ability, experience, and other factors correlated with education.</p>
                    <p><strong>Multiple Regression Solution:</strong></p>
                    <div class="formula-box">
                        wage = Œ≤‚ÇÄ + Œ≤‚ÇÅ ¬∑ educ + Œ≤‚ÇÇ ¬∑ exper + Œ≤‚ÇÉ ¬∑ abil + u
                    </div>
                    <p>Now Œ≤‚ÇÅ measures the ceteris paribus effect of education, holding experience and ability constant.</p>
                </div>
                
                <div class="key-insight">
                    <div class="insight-title">Partial Effects</div>
                    <p>In the multiple regression model, Œ≤‚±º measures the change in y with respect to x‚±º, holding all other explanatory variables fixed:</p>
                    <div class="formula-box">
                        Œ≤‚±º = ‚àÇy/‚àÇx‚±º = Œîy/Œîx‚±º, ceteris paribus
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Knowledge Check -->
        <section class="section">
            <div class="interactive-widget">
                <h3 class="widget-title">üí° Knowledge Check: Motivation for Multiple Regression</h3>
                <p class="widget-description">Test your understanding of why we need multiple explanatory variables</p>
                
                <div class="quiz-question">
                    <p><strong>Question 1:</strong> Omitted variable bias occurs when:</p>
                    <div class="quiz-options">
                        <label onclick="selectAnswer('3-1', 'A')">
                            <input type="radio" name="q3-1" value="A"> 
                            A) We include too many variables in the regression
                        </label>
                        <label onclick="selectAnswer('3-1', 'B')">
                            <input type="radio" name="q3-1" value="B">
                            B) An important variable is left out AND it's correlated with an included variable
                        </label>
                        <label onclick="selectAnswer('3-1', 'C')">
                            <input type="radio" name="q3-1" value="C">
                            C) The sample size is too small
                        </label>
                        <label onclick="selectAnswer('3-1', 'D')">
                            <input type="radio" name="q3-1" value="D">
                            D) There are measurement errors in the data
                        </label>
                    </div>
                    <div id="feedback3-1" class="quiz-feedback" style="display: none;"></div>
                </div>

                <div class="quiz-question">
                    <p><strong>Question 2:</strong> In the model wage = Œ≤‚ÇÄ + Œ≤‚ÇÅ¬∑educ + Œ≤‚ÇÇ¬∑exper + u, the coefficient Œ≤‚ÇÅ represents:</p>
                    <div class="quiz-options">
                        <label onclick="selectAnswer('3-2', 'A')">
                            <input type="radio" name="q3-2" value="A">
                            A) The total effect of education on wages
                        </label>
                        <label onclick="selectAnswer('3-2', 'B')">
                            <input type="radio" name="q3-2" value="B">
                            B) The effect of education on wages, holding experience constant
                        </label>
                        <label onclick="selectAnswer('3-2', 'C')">
                            <input type="radio" name="q3-2" value="C">
                            C) The correlation between education and wages
                        </label>
                        <label onclick="selectAnswer('3-2', 'D')">
                            <input type="radio" name="q3-2" value="D">
                            D) The effect when education and experience both increase
                        </label>
                    </div>
                    <div id="feedback3-2" class="quiz-feedback" style="display: none;"></div>
                </div>

                <div class="quiz-question">
                    <p><strong>Question 3:</strong> The term "ceteris paribus" in multiple regression means:</p>
                    <div class="quiz-options">
                        <label onclick="selectAnswer('3-3', 'A')">
                            <input type="radio" name="q3-3" value="A">
                            A) All variables change simultaneously
                        </label>
                        <label onclick="selectAnswer('3-3', 'B')">
                            <input type="radio" name="q3-3" value="B">
                            B) All other things being equal (holding other variables constant)
                        </label>
                        <label onclick="selectAnswer('3-3', 'C')">
                            <input type="radio" name="q3-3" value="C">
                            C) The model assumes perfect correlation
                        </label>
                        <label onclick="selectAnswer('3-3', 'D')">
                            <input type="radio" name="q3-3" value="D">
                            D) Variables are measured without error
                        </label>
                    </div>
                    <div id="feedback3-3" class="quiz-feedback" style="display: none;"></div>
                </div>
            </div>
        </section>

        <!-- Section 3.2: Mechanics of OLS -->
        <section class="section">
            <h2 class="section-title">3.2 Mechanics of OLS with Multiple Regressors</h2>
            
            <div class="content-card">
                <p>With multiple explanatory variables, OLS chooses the estimates to minimize the sum of squared residuals, just as in simple regression.</p>
                
                <h3 class="subsection-title">The Sample Regression Function</h3>
                
                <p>For a sample of n observations, we estimate:</p>
                
                <div class="formula-box">
                    ≈∑·µ¢ = Œ≤ÃÇ‚ÇÄ + Œ≤ÃÇ‚ÇÅx‚ÇÅ·µ¢ + Œ≤ÃÇ‚ÇÇx‚ÇÇ·µ¢ + ‚ãØ + Œ≤ÃÇ‚Çñx‚Çñ·µ¢
                </div>
                
                <p>The residual for observation i is:</p>
                
                <div class="formula-box">
                    √ª·µ¢ = y·µ¢ - ≈∑·µ¢ = y·µ¢ - Œ≤ÃÇ‚ÇÄ - Œ≤ÃÇ‚ÇÅx‚ÇÅ·µ¢ - ‚ãØ - Œ≤ÃÇ‚Çñx‚Çñ·µ¢
                </div>
                
                <div class="key-insight">
                    <div class="insight-title">OLS Minimization Problem</div>
                    <p>OLS chooses the parameter estimates to minimize:</p>
                    <div class="formula-box">
                        min Œ£√ª·µ¢¬≤ = min Œ£(y·µ¢ - Œ≤ÃÇ‚ÇÄ - Œ≤ÃÇ‚ÇÅx‚ÇÅ·µ¢ - ‚ãØ - Œ≤ÃÇ‚Çñx‚Çñ·µ¢)¬≤
                    </div>
                </div>
                
                <div class="definition-box">
                    <div class="definition-title">First-Order Conditions for Multiple Regression</div>
                    <div class="formula-box">
                        Œ£√ª·µ¢ = 0<br><br>
                        Œ£x‚±º·µ¢√ª·µ¢ = 0, for j = 1, 2, ‚Ä¶, k
                    </div>
                </div>
            </div>
        </section>

        <!-- Simple Multiple Regression Calculator -->
        <section class="section">
            <div class="interactive-widget">
                <h3 class="widget-title">üßÆ Multiple Regression Calculator</h3>
                <p class="widget-description">
                    Explore how multiple explanatory variables work together and see the effects of multicollinearity
                </p>
                
                <div class="controls-group">
                    <div class="control">
                        <label for="multiScenario" class="control-label">Economic Model:</label>
                        <select id="multiScenario" class="control-select" onchange="generateRegressionData()">
                            <option value="wage-educ-exper">Wages = f(Education, Experience)</option>
                            <option value="consumption-income-wealth">Consumption = f(Income, Wealth)</option>
                            <option value="house-price-size-location">House Price = f(Size, Location Score)</option>
                        </select>
                    </div>
                    <div class="control">
                        <label for="correlationLevel" class="control-label">X‚ÇÅ-X‚ÇÇ Correlation:</label>
                        <select id="correlationLevel" class="control-select" onchange="generateRegressionData()">
                            <option value="low">Low Correlation (r ‚âà 0.2)</option>
                            <option value="medium">Medium Correlation (r ‚âà 0.5)</option>
                            <option value="high">High Correlation (r ‚âà 0.8)</option>
                            <option value="perfect">Near Perfect (r ‚âà 0.95)</option>
                        </select>
                    </div>
                    <div class="control">
                        <label for="multiSampleSize" class="control-label">Sample Size:</label>
                        <select id="multiSampleSize" class="control-select" onchange="generateRegressionData()">
                            <option value="30">Small (n=30)</option>
                            <option value="100">Medium (n=100)</option>
                            <option value="200">Large (n=200)</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                    <button class="btn btn-success" onclick="generateRegressionData()">
                        <span class="icon icon-dice"></span>
                        Generate New Sample
                    </button>
                    <button class="btn btn-warning" onclick="showOmittedVariableBias()">
                        <span class="icon icon-eye"></span>
                        Show Omitted Variable Bias
                    </button>
                </div>
                
                <div class="results-panel" id="multipleRegressionResults">
                    <div class="results-title">
                        <span class="icon icon-chart"></span>
                        Multiple Regression Results
                    </div>
                    
                    <div class="visualization-simple">
                        <div id="simpleVisualization" style="width: 100%; height: 250px; background: var(--gray-50); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--gray-600); flex-direction: column; gap: 1rem;">
                            <div style="font-size: 3rem;">üìä</div>
                            <div>Click "Generate New Sample" to see regression results</div>
                        </div>
                    </div>
                    
                    <div class="coefficient-grid" id="coefficientsGrid">
                        <!-- Results will be populated by JavaScript -->
                    </div>
                    
                    <div style="margin-top: 1.5rem; padding: 1rem; background: var(--gray-50); border-radius: 8px; border-left: 4px solid var(--primary-indigo);">
                        <div style="font-weight: 600; color: var(--primary-indigo); margin-bottom: 0.5rem;">Interpretation:</div>
                        <div id="interpretationText">Click "Generate New Sample" to see interpretation.</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3.3: Expected Value of OLS Estimators -->
        <section class="section">
            <h2 class="section-title">3.3 Expected Value of OLS Estimators</h2>
            
            <div class="content-card">
                <p>For OLS to be unbiased in multiple regression, we need the following assumptions:</p>
                
                <div class="definition-box">
                    <div class="definition-title">Multiple Linear Regression Assumptions (MLR.1-MLR.4)</div>
                    <p><strong>MLR.1 (Linear in Parameters):</strong> The model is linear in the parameters Œ≤‚±º</p>
                    <div class="formula-box">
                        y = Œ≤‚ÇÄ + Œ≤‚ÇÅx‚ÇÅ + Œ≤‚ÇÇx‚ÇÇ + ‚ãØ + Œ≤‚Çñx‚Çñ + u
                    </div>
                    
                    <p><strong>MLR.2 (Random Sampling):</strong> We have a random sample of size n</p>
                    
                    <p><strong>MLR.3 (No Perfect Multicollinearity):</strong> No explanatory variable is constant, and there are no exact linear relationships among the explanatory variables</p>
                    
                    <p><strong>MLR.4 (Zero Conditional Mean):</strong> The error u has expected value zero given any values of the explanatory variables:</p>
                    <div class="formula-box">
                        E(u|x‚ÇÅ, x‚ÇÇ, ‚Ä¶, x‚Çñ) = 0
                    </div>
                </div>
                
                <div class="key-insight">
                    <div class="insight-title">Unbiasedness of OLS</div>
                    <p>Under assumptions MLR.1-MLR.4, the OLS estimators are unbiased:</p>
                    <div class="formula-box">
                        E(Œ≤ÃÇ‚±º) = Œ≤‚±º, for j = 0, 1, 2, ‚Ä¶, k
                    </div>
                </div>
                
                <div class="warning-box">
                    <div class="warning-title">Perfect Multicollinearity</div>
                    <p>Perfect multicollinearity occurs when one explanatory variable is an exact linear function of other explanatory variables. When this happens:</p>
                    <ul style="margin-top: 1rem; padding-left: 2rem;">
                        <li>OLS coefficients are not uniquely defined</li>
                        <li>Statistical software will drop one of the perfectly correlated variables</li>
                        <li>Common causes: including both x and 2x as regressors, dummy variable trap</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 3.4: Variance of OLS Estimators -->
        <section class="section">
            <h2 class="section-title">3.4 Variance of OLS Estimators</h2>
            
            <div class="content-card">
                <p>To derive the variance of OLS estimators, we need an additional assumption:</p>
                
                <div class="definition-box">
                    <div class="definition-title">MLR.5 (Homoskedasticity)</div>
                    <p>The error u has the same variance given any values of the explanatory variables:</p>
                    <div class="formula-box">
                        Var(u|x‚ÇÅ, x‚ÇÇ, ‚Ä¶, x‚Çñ) = œÉ¬≤
                    </div>
                </div>
                
                <div class="key-insight">
                    <div class="insight-title">Variance of Œ≤ÃÇ‚±º</div>
                    <p>Under assumptions MLR.1-MLR.5, the variance of Œ≤ÃÇ‚±º is:</p>
                    <div class="formula-box">
                        Var(Œ≤ÃÇ‚±º) = œÉ¬≤/[SST‚±º(1-R¬≤‚±º)]
                    </div>
                    <p>Where:</p>
                    <ul style="margin-top: 1rem; padding-left: 2rem;">
                        <li>SST‚±º = Œ£(x‚±º·µ¢ - xÃÑ‚±º)¬≤ is the total sample variation in x‚±º</li>
                        <li>R¬≤‚±º is the R-squared from regressing x‚±º on all other explanatory variables</li>
                    </ul>
                </div>
                
                <div class="definition-box">
                    <div class="definition-title">Variance Inflation Factor (VIF)</div>
                    <p>The VIF measures how much the variance of Œ≤ÃÇ‚±º is inflated due to multicollinearity:</p>
                    <div class="formula-box">
                        VIF‚±º = 1/(1-R¬≤‚±º)
                    </div>
                    <p><strong>Interpretation:</strong></p>
                    <ul style="margin-top: 1rem; padding-left: 2rem;">
                        <li>VIF = 1: No multicollinearity (R¬≤‚±º = 0)</li>
                        <li>VIF > 5: Moderate multicollinearity concern</li>
                        <li>VIF > 10: Serious multicollinearity problem</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 3.5: Gauss-Markov Theorem -->
        <section class="section">
            <h2 class="section-title">3.5 The Gauss-Markov Theorem</h2>
            
            <div class="content-card">
                <div class="key-insight">
                    <div class="insight-title">Gauss-Markov Theorem</div>
                    <p>Under assumptions MLR.1-MLR.5, the OLS estimators Œ≤ÃÇ‚ÇÄ, Œ≤ÃÇ‚ÇÅ, ‚Ä¶, Œ≤ÃÇ‚Çñ are the <strong>Best Linear Unbiased Estimators (BLUE)</strong> of Œ≤‚ÇÄ, Œ≤‚ÇÅ, ‚Ä¶, Œ≤‚Çñ.</p>
                    
                    <p><strong>"Best"</strong> means they have the smallest variance among all linear unbiased estimators.</p>
                </div>
                
                <div class="definition-box">
                    <div class="definition-title">BLUE Properties</div>
                    <ol style="padding-left: 2rem;">
                        <li><strong>Linear:</strong> The estimator is a linear function of the dependent variable y</li>
                        <li><strong>Unbiased:</strong> E(Œ≤ÃÇ‚±º) = Œ≤‚±º</li>
                        <li><strong>Best:</strong> Has minimum variance among all linear unbiased estimators</li>
                    </ol>
                </div>
                
                <div class="example-box">
                    <div class="example-title">When Gauss-Markov Doesn't Apply</div>
                    <p>The Gauss-Markov theorem may not apply when:</p>
                    <ul style="margin-top: 1rem; padding-left: 2rem;">
                        <li>Heteroskedasticity is present (MLR.5 violated)</li>
                        <li>Serial correlation exists in time series data</li>
                        <li>Explanatory variables are not strictly exogenous</li>
                        <li>The model is misspecified</li>
                    </ul>
                    <p>In these cases, other estimators (like GLS or instrumental variables) may be more efficient.</p>
                </div>
            </div>
        </section>

    </div>

    <!-- BULLETPROOF JavaScript - NO External Dependencies -->
    <script>
        // ========================================
        // ZERO EXTERNAL DEPENDENCIES VERSION
        // ========================================
        
        // Global variables
        let multipleRegressionData = [];
        let isOmittedVariableBiasMode = false;
        
        // Quiz answers
        const quizAnswers = {
            '3-1': { 
                correct: 'B', 
                explanation: 'Correct! Omitted variable bias requires both conditions: the omitted variable must affect y AND be correlated with an included explanatory variable.' 
            },
            '3-2': { 
                correct: 'B', 
                explanation: 'Correct! In multiple regression, Œ≤‚ÇÅ measures the ceteris paribus effect - how wages change with education, holding experience constant.' 
            },
            '3-3': { 
                correct: 'B', 
                explanation: 'Correct! "Ceteris paribus" means "all other things being equal" - the key concept that allows us to isolate partial effects in multiple regression.' 
            }
        };
        
        // ========================================
        // REGRESSION CALCULATOR - PURE JAVASCRIPT
        // ========================================
        
        function generateRegressionData() {
            try {
                const scenario = document.getElementById('multiScenario')?.value || 'wage-educ-exper';
                const correlationLevel = document.getElementById('correlationLevel')?.value || 'medium';
                const sampleSize = parseInt(document.getElementById('multiSampleSize')?.value) || 100;
                
                isOmittedVariableBiasMode = false;
                multipleRegressionData = [];
                
                // Correlation levels
                const correlations = { 'low': 0.2, 'medium': 0.5, 'high': 0.8, 'perfect': 0.95 };
                const correlation = correlations[correlationLevel];
                
                // Generate data based on scenario
                let xLabel, yLabel, zLabel, trueIntercept, trueSlope1, trueSlope2;
                
                if (scenario === 'wage-educ-exper') {
                    xLabel = 'Education (years)'; 
                    yLabel = 'Experience (years)'; 
                    zLabel = 'Wage ($1000s)';
                    trueIntercept = 10; 
                    trueSlope1 = 2.5; 
                    trueSlope2 = 1.2;
                    
                    for (let i = 0; i < sampleSize; i++) {
                        const educ = 12 + Math.random() * 8;
                        const educStd = (educ - 16) / 3;
                        const experStd = correlation * educStd + Math.sqrt(1 - correlation * correlation) * (Math.random() - 0.5) * 2;
                        const exper = Math.max(0, 5 + experStd * 3 + Math.random() * 10);
                        const error = (Math.random() - 0.5) * 8;
                        const wage = trueIntercept + trueSlope1 * educ + trueSlope2 * exper + error;
                        multipleRegressionData.push({ x: educ, y: exper, z: wage });
                    }
                } else if (scenario === 'consumption-income-wealth') {
                    xLabel = 'Income ($1000s)'; 
                    yLabel = 'Wealth ($1000s)'; 
                    zLabel = 'Consumption ($1000s)';
                    trueIntercept = 5; 
                    trueSlope1 = 0.7; 
                    trueSlope2 = 0.05;
                    
                    for (let i = 0; i < sampleSize; i++) {
                        const income = 30 + Math.random() * 70;
                        const incomeStd = (income - 65) / 25;
                        const wealthStd = correlation * incomeStd + Math.sqrt(1 - correlation * correlation) * (Math.random() - 0.5) * 2;
                        const wealth = Math.max(0, 50 + wealthStd * 100 + Math.random() * 200);
                        const error = (Math.random() - 0.5) * 10;
                        const consumption = trueIntercept + trueSlope1 * income + trueSlope2 * wealth + error;
                        multipleRegressionData.push({ x: income, y: wealth, z: consumption });
                    }
                } else {
                    xLabel = 'Size (sqft)'; 
                    yLabel = 'Location Score (1-10)'; 
                    zLabel = 'Price ($1000s)';
                    trueIntercept = 50; 
                    trueSlope1 = 0.15; 
                    trueSlope2 = 25;
                    
                    for (let i = 0; i < sampleSize; i++) {
                        const size = 1000 + Math.random() * 2000;
                        const sizeStd = (size - 2000) / 600;
                        const locationStd = correlation * sizeStd + Math.sqrt(1 - correlation * correlation) * (Math.random() - 0.5) * 2;
                        const location = Math.max(1, Math.min(10, 5.5 + locationStd * 2));
                        const error = (Math.random() - 0.5) * 40;
                        const price = trueIntercept + trueSlope1 * size + trueSlope2 * location + error;
                        multipleRegressionData.push({ x: size, y: location, z: price });
                    }
                }
                
                // Calculate and display regression
                calculateAndDisplayRegression(xLabel, yLabel, zLabel);
                
            } catch (error) {
                console.log('Error in regression calculation:', error);
                safeUpdateResults('Error generating data. Please try again.');
            }
        }
        
        function calculateAndDisplayRegression(xLabel, yLabel, zLabel) {
            try {
                const data = multipleRegressionData;
                const n = data.length;
                
                // Calculate means
                const xMean = data.reduce((sum, point) => sum + point.x, 0) / n;
                const yMean = data.reduce((sum, point) => sum + point.y, 0) / n;
                const zMean = data.reduce((sum, point) => sum + point.z, 0) / n;
                
                // Calculate sums for regression
                let sumXX = 0, sumYY = 0, sumXY = 0, sumXZ = 0, sumYZ = 0;
                
                for (const point of data) {
                    const xDev = point.x - xMean;
                    const yDev = point.y - yMean;
                    const zDev = point.z - zMean;
                    
                    sumXX += xDev * xDev;
                    sumYY += yDev * yDev;
                    sumXY += xDev * yDev;
                    sumXZ += xDev * zDev;
                    sumYZ += yDev * zDev;
                }
                
                // Solve regression equations
                const denominator = sumXX * sumYY - sumXY * sumXY;
                const beta1Hat = (sumXZ * sumYY - sumYZ * sumXY) / denominator;
                const beta2Hat = (sumYZ * sumXX - sumXZ * sumXY) / denominator;
                const beta0Hat = zMean - beta1Hat * xMean - beta2Hat * yMean;
                
                // Calculate R-squared
                let SSE = 0, SSR = 0, SST = 0;
                for (const point of data) {
                    const predicted = beta0Hat + beta1Hat * point.x + beta2Hat * point.y;
                    const residual = point.z - predicted;
                    SSE += Math.pow(predicted - zMean, 2);
                    SSR += residual * residual;
                    SST += Math.pow(point.z - zMean, 2);
                }
                
                const rSquared = SSE / SST;
                const adjustedRSquared = 1 - ((SSR / (n - 3)) / (SST / (n - 1)));
                
                // Calculate correlation and VIF
                const correlationXY = sumXY / Math.sqrt(sumXX * sumYY);
                const vif = 1 / (1 - correlationXY * correlationXY);
                
                // Display results
                displayRegressionResults(beta0Hat, beta1Hat, beta2Hat, rSquared, adjustedRSquared, vif, n, correlationXY, xLabel, yLabel, zLabel);
                
            } catch (error) {
                console.log('Error calculating regression:', error);
                safeUpdateResults('Calculation error. Please generate new data.');
            }
        }
        
        function displayRegressionResults(beta0, beta1, beta2, rSquared, adjustedRSquared, vif, n, correlation, xLabel, yLabel, zLabel) {
            try {
                // Update visualization with simple text display
                const vizElement = document.getElementById('simpleVisualization');
                if (vizElement) {
                    vizElement.innerHTML = `
                        <div style="text-align: center; padding: 2rem;">
                            <div style="font-weight: 600; color: var(--primary-indigo); margin-bottom: 1rem; font-size: 1.1rem;">Regression Equation</div>
                            <div style="font-family: monospace; font-size: 1.2rem; background: white; padding: 1.5rem; border-radius: 6px; border: 1px solid var(--gray-300); margin: 1rem 0;">
                                ${zLabel} = ${beta0.toFixed(2)} + ${beta1.toFixed(3)}√ó${xLabel} + ${beta2.toFixed(3)}√ó${yLabel}
                            </div>
                            <div style="margin-top: 1.5rem; color: var(--gray-600); font-size: 1rem;">
                                <div style="margin-bottom: 0.5rem;">üìä Sample size: ${n} observations</div>
                                <div>üìà R¬≤ = ${rSquared.toFixed(3)}, Adjusted R¬≤ = ${adjustedRSquared.toFixed(3)}</div>
                            </div>
                        </div>
                    `;
                }
                
                // Update coefficients grid
                const coefficientsHTML = `
                    <div class="coefficient-card">
                        <div class="coefficient-label">Intercept (Œ≤‚ÇÄ)</div>
                        <div class="coefficient-value">${beta0.toFixed(2)}</div>
                        <div style="font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem;">Constant term</div>
                    </div>
                    <div class="coefficient-card">
                        <div class="coefficient-label">Œ≤‚ÇÅ (${xLabel})</div>
                        <div class="coefficient-value">${beta1.toFixed(3)}</div>
                        <div style="font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem;">VIF: ${vif.toFixed(2)}</div>
                    </div>
                    <div class="coefficient-card">
                        <div class="coefficient-label">Œ≤‚ÇÇ (${yLabel})</div>
                        <div class="coefficient-value">${beta2.toFixed(3)}</div>
                        <div style="font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem;">VIF: ${vif.toFixed(2)}</div>
                    </div>
                    <div class="coefficient-card">
                        <div class="coefficient-label">Goodness of Fit</div>
                        <div class="coefficient-value">${rSquared.toFixed(3)}</div>
                        <div style="font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem;">R-squared</div>
                    </div>
                    <div class="coefficient-card">
                        <div class="coefficient-label">Multicollinearity</div>
                        <div class="coefficient-value">${correlation.toFixed(3)}</div>
                        <div style="font-size: 0.8rem; color: var(--gray-600); margin-top: 0.25rem;">Correlation X‚ÇÅ, X‚ÇÇ</div>
                    </div>
                `;
                
                const coefficientsGrid = document.getElementById('coefficientsGrid');
                if (coefficientsGrid) {
                    coefficientsGrid.innerHTML = coefficientsHTML;
                }
                
                // Update interpretation
                const vifWarning = vif > 5 ? `<br><br><strong>‚ö†Ô∏è Note:</strong> High multicollinearity detected (VIF = ${vif.toFixed(2)}) - individual coefficient estimates are less precise.` : '';
                
                const interpretationHTML = `
                    <strong>Ceteris Paribus Interpretation:</strong><br>
                    ‚Ä¢ Holding ${yLabel.toLowerCase()} constant, a one-unit increase in ${xLabel.toLowerCase()} is associated with a <strong>${Math.abs(beta1).toFixed(3)} ${beta1 >= 0 ? 'increase' : 'decrease'}</strong> in ${zLabel.toLowerCase()}.<br>
                    ‚Ä¢ Holding ${xLabel.toLowerCase()} constant, a one-unit increase in ${yLabel.toLowerCase()} is associated with a <strong>${Math.abs(beta2).toFixed(3)} ${beta2 >= 0 ? 'increase' : 'decrease'}</strong> in ${zLabel.toLowerCase()}.<br>
                    ‚Ä¢ The model explains <strong>${(rSquared * 100).toFixed(1)}%</strong> of the variation in ${zLabel.toLowerCase()}.
                    ${vifWarning}
                `;
                
                const interpretationText = document.getElementById('interpretationText');
                if (interpretationText) {
                    interpretationText.innerHTML = interpretationHTML;
                }
                
                console.log('Regression results displayed successfully');
                
            } catch (error) {
                console.log('Error displaying results:', error);
                safeUpdateResults('Display error occurred.');
            }
        }
        
        function safeUpdateResults(message) {
            const coefficientsGrid = document.getElementById('coefficientsGrid');
            const interpretationText = document.getElementById('interpretationText');
            
            if (coefficientsGrid) {
                coefficientsGrid.innerHTML = `<div style="text-align: center; padding: 2rem; color: var(--gray-600); grid-column: 1 / -1;">${message}</div>`;
            }
            if (interpretationText) {
                interpretationText.innerHTML = message;
            }
        }
        
        function showOmittedVariableBias() {
            try {
                if (!isOmittedVariableBiasMode && multipleRegressionData.length > 0) {
                    isOmittedVariableBiasMode = true;
                    
                    const data = multipleRegressionData;
                    const n = data.length;
                    const xMean = data.reduce((sum, point) => sum + point.x, 0) / n;
                    const zMean = data.reduce((sum, point) => sum + point.z, 0) / n;
                    
                    // Simple regression calculation (omitting y variable)
                    const numerator = data.reduce((sum, point) => sum + (point.x - xMean) * (point.z - zMean), 0);
                    const denominator = data.reduce((sum, point) => sum + Math.pow(point.x - xMean, 2), 0);
                    const simpleSlope = numerator / denominator;
                    const simpleIntercept = zMean - simpleSlope * xMean;
                    
                    // Calculate simple R-squared
                    let simpleSSE = 0, simpleSST = 0;
                    for (const point of data) {
                        const simplePredicted = simpleIntercept + simpleSlope * point.x;
                        simpleSSE += Math.pow(simplePredicted - zMean, 2);
                        simpleSST += Math.pow(point.z - zMean, 2);
                    }
                    const simpleRSquared = simpleSSE / simpleSST;
                    
                    const scenario = document.getElementById('multiScenario')?.value || 'wage-educ-exper';
                    let omittedVar = scenario === 'wage-educ-exper' ? 'Experience' : 
                                    scenario === 'consumption-income-wealth' ? 'Wealth' : 'Location Score';
                    
                    // Get current multiple regression results
                    const multipleCoeffElement = document.querySelector('.coefficient-card:nth-child(2) .coefficient-value');
                    const multipleR2Element = document.querySelector('.coefficient-card:nth-child(4) .coefficient-value');
                    
                    if (multipleCoeffElement && multipleR2Element) {
                        const multipleCoeff = parseFloat(multipleCoeffElement.textContent);
                        const multipleR2 = parseFloat(multipleR2Element.textContent);
                        
                        const interpretationElement = document.getElementById('interpretationText');
                        if (interpretationElement) {
                            const bias = simpleSlope - multipleCoeff;
                            interpretationElement.innerHTML = `
                                <div style="background: #fef2f2; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #dc2626;">
                                    <div style="color: #dc2626; font-weight: 700; margin-bottom: 1rem; font-size: 1.1rem;">üö® Omitted Variable Bias Demonstration</div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <strong>Multiple Regression (Correct):</strong><br>
                                        Œ≤‚ÇÅ = ${multipleCoeff.toFixed(3)}, R¬≤ = ${multipleR2.toFixed(3)}
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <strong>Simple Regression (Omitting ${omittedVar}):</strong><br>
                                        Œ≤‚ÇÅ = ${simpleSlope.toFixed(3)}, R¬≤ = ${simpleRSquared.toFixed(3)}
                                    </div>
                                    
                                    <div style="background: white; padding: 1rem; border-radius: 6px; margin-top: 1rem;">
                                        <strong>Bias Amount:</strong> ${bias.toFixed(3)} 
                                        (${Math.abs(bias / multipleCoeff * 100).toFixed(1)}% ${bias > 0 ? 'overestimate' : 'underestimate'})<br>
                                        <em>The simple regression coefficient captures both the direct effect and the effect through the omitted variable.</em>
                                    </div>
                                </div>
                            `;
                        }
                    }
                }
            } catch (error) {
                console.log('Error in bias demonstration:', error);
                const interpretationElement = document.getElementById('interpretationText');
                if (interpretationElement) {
                    interpretationElement.innerHTML = `
                        <div style="background: #fef2f2; padding: 1rem; border-radius: 6px;">
                            <strong>‚ö†Ô∏è Demo temporarily unavailable.</strong> Please generate a new sample and try again.
                        </div>
                    `;
                }
            }
        }
        
        // ========================================
        // QUIZ FUNCTIONS
        // ========================================
        
        function selectAnswer(questionId, selectedAnswer) {
            try {
                const question = quizAnswers[questionId];
                if (!question) return;
                
                const feedbackDiv = document.getElementById(`feedback${questionId}`);
                const options = document.querySelectorAll(`input[name="q${questionId}"]`);
                
                // Remove previous selections
                options.forEach(option => {
                    if (option && option.parentElement) {
                        option.parentElement.classList.remove('selected', 'correct', 'incorrect');
                    }
                });
                
                // Mark selected option
                const selectedOption = document.querySelector(`input[name="q${questionId}"][value="${selectedAnswer}"]`);
                if (selectedOption && selectedOption.parentElement) {
                    selectedOption.parentElement.classList.add('selected');
                }
                
                // Show feedback
                if (feedbackDiv) {
                    feedbackDiv.style.display = 'block';
                    
                    if (selectedAnswer === question.correct) {
                        if (selectedOption && selectedOption.parentElement) {
                            selectedOption.parentElement.classList.add('correct');
                        }
                        feedbackDiv.className = 'quiz-feedback correct';
                        feedbackDiv.innerHTML = `‚úÖ ${question.explanation}`;
                    } else {
                        if (selectedOption && selectedOption.parentElement) {
                            selectedOption.parentElement.classList.add('incorrect');
                        }
                        feedbackDiv.className = 'quiz-feedback incorrect';
                        
                        // Highlight correct answer
                        const correctOption = document.querySelector(`input[name="q${questionId}"][value="${question.correct}"]`);
                        if (correctOption && correctOption.parentElement) {
                            correctOption.parentElement.classList.add('correct');
                        }
                        
                        feedbackDiv.innerHTML = `‚ùå Incorrect. ${question.explanation}`;
                    }
                }
                
                console.log(`Quiz ${questionId}: Selected ${selectedAnswer}, Correct: ${question.correct}`);
                
            } catch (error) {
                console.log('Error in selectAnswer:', error);
            }
        }
        
        function showChapter4ComingSoon() {
            alert(`üöß Chapter 4: Multiple Regression Analysis - Inference - Coming Soon!

üìö Chapter 4 will cover:
‚Ä¢ Statistical inference for multiple regression
‚Ä¢ t-tests and F-tests for individual and joint significance
‚Ä¢ Confidence intervals for coefficients
‚Ä¢ Testing linear restrictions

‚úÖ Currently Available:
‚Ä¢ Chapter 1: Introduction to Econometrics
‚Ä¢ Chapter 2: Simple Regression Model  
‚Ä¢ Chapter 3: Multiple Regression Analysis (Current)

üéØ Continue Learning:
Explore the interactive calculator and try different correlation levels to see how multicollinearity affects your estimates!`);
        }
        
        // ========================================
        // INITIALIZATION - SAFE AND SIMPLE
        // ========================================
        
        // Initialize when DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Chapter 3 loaded successfully - Zero external dependencies!');
            
            // Generate initial regression data after a short delay
            setTimeout(function() {
                try {
                    generateRegressionData();
                    console.log('Initial regression data generated successfully');
                } catch (error) {
                    console.log('Error during initial data generation:', error);
                }
            }, 500);
        });
        
        // Backup initialization
        window.addEventListener('load', function() {
            console.log('Window fully loaded');
            if (!multipleRegressionData.length) {
                setTimeout(function() {
                    try {
                        generateRegressionData();
                    } catch (error) {
                        console.log('Backup initialization failed:', error);
                    }
                }, 1000);
            }
        });
        
        console.log('Chapter 3 JavaScript loaded - Ready for interaction!');
        
    </script>
</body>
</html>
